paths:
  /books:
    get:
      tags: [Books]
      summary: Get all books
      description: Returns a paginated list of books for the authenticated user, with optional filtering by status and search.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum: [WANT_TO_READ, READING, FINISHED, ABANDONED]
          description: Filter by book status
        - in: query
          name: search
          schema:
            type: string
          description: Search by title or author
        - in: query
          name: limit
          schema:
            type: integer
            default: 20
            maximum: 100
          description: Number of books to return
        - in: query
          name: offset
          schema:
            type: integer
            default: 0
          description: Number of books to skip
      responses:
        200:
          description: List of books
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Book'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        401:
          description: Unauthorized
        429:
          description: Too many requests
    post:
      tags: [Books]
      summary: Create a new book
      description: Creates a new book for the authenticated user.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  maxLength: 200
                author:
                  type: string
                  maxLength: 200
                coverUrl:
                  type: string
                  format: uri
                  nullable: true
                totalPages:
                  type: integer
                  minimum: 1
                  nullable: true
                status:
                  type: string
                  enum: [WANT_TO_READ, READING, FINISHED, ABANDONED]
                notes:
                  type: string
                  maxLength: 2000
      responses:
        201:
          description: Book created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Book'
        400:
          description: Validation error
        401:
          description: Unauthorized
        429:
          description: Too many requests

  /books/stats:
    get:
      tags: [Books]
      summary: Get reading statistics
      description: Returns reading statistics for the authenticated user, optionally filtered by year.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: year
          schema:
            type: integer
            minimum: 2020
            maximum: 2100
          description: Filter stats by year
      responses:
        200:
          description: Reading statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
        401:
          description: Unauthorized
        429:
          description: Too many requests

  /books/current:
    get:
      tags: [Books]
      summary: Get currently reading book
      description: Returns the book the authenticated user is currently reading (for dashboard widget).
      security:
        - bearerAuth: []
      responses:
        200:
          description: Currently reading book
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Book'
        401:
          description: Unauthorized
        429:
          description: Too many requests

  /books/{id}:
    get:
      tags: [Books]
      summary: Get book by ID
      description: Returns a single book by its ID for the authenticated user.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Book ID
      responses:
        200:
          description: Book details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Book'
        401:
          description: Unauthorized
        404:
          description: Book not found
        429:
          description: Too many requests
    put:
      tags: [Books]
      summary: Update a book
      description: Updates an existing book for the authenticated user.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Book ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  maxLength: 200
                author:
                  type: string
                  maxLength: 200
                  nullable: true
                coverUrl:
                  type: string
                  format: uri
                  nullable: true
                totalPages:
                  type: integer
                  minimum: 1
                  nullable: true
                currentPage:
                  type: integer
                  minimum: 0
                status:
                  type: string
                  enum: [WANT_TO_READ, READING, FINISHED, ABANDONED]
                rating:
                  type: integer
                  minimum: 1
                  maximum: 5
                  nullable: true
                notes:
                  type: string
                  maxLength: 2000
                  nullable: true
                startedAt:
                  type: string
                  format: date-time
                  nullable: true
                finishedAt:
                  type: string
                  format: date-time
                  nullable: true
      responses:
        200:
          description: Book updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Book'
        400:
          description: Validation error
        401:
          description: Unauthorized
        404:
          description: Book not found
        429:
          description: Too many requests
    delete:
      tags: [Books]
      summary: Delete a book
      description: Deletes a book by its ID for the authenticated user.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Book ID
      responses:
        200:
          description: Book deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      message:
                        type: string
        401:
          description: Unauthorized
        404:
          description: Book not found
        429:
          description: Too many requests

  /books/{id}/progress:
    put:
      tags: [Books]
      summary: Update reading progress
      description: Sets the current page for a book, updating reading progress.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Book ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - currentPage
              properties:
                currentPage:
                  type: integer
                  minimum: 0
                notes:
                  type: string
                  maxLength: 500
      responses:
        200:
          description: Progress updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Book'
        400:
          description: Validation error
        401:
          description: Unauthorized
        404:
          description: Book not found
        429:
          description: Too many requests

  /books/{id}/log:
    post:
      tags: [Books]
      summary: Log a reading session
      description: Logs pages read in a reading session for the specified book.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Book ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - pagesRead
              properties:
                pagesRead:
                  type: integer
                  minimum: 1
                date:
                  type: string
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                  description: Date in YYYY-MM-DD format
                notes:
                  type: string
                  maxLength: 500
      responses:
        201:
          description: Reading session logged successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
        400:
          description: Validation error
        401:
          description: Unauthorized
        404:
          description: Book not found
        429:
          description: Too many requests

  /books/{id}/logs:
    get:
      tags: [Books]
      summary: Get reading logs for a book
      description: Returns all reading session logs for the specified book.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Book ID
      responses:
        200:
          description: List of reading logs
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
        401:
          description: Unauthorized
        404:
          description: Book not found
        429:
          description: Too many requests
